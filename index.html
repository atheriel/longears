<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Fast and Fully-Featured RabbitMQ Client • longears</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A Fast and Fully-Featured RabbitMQ Client">
<meta property="og:description" content="Provides a client for the RabbitMQ message broker, allowing users
  to publish and consume messages via the Advanced Message Queuing Protocol
  (AMQP), as well as declare, delete, and bind the exchanges and queues used to
  route them.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">longears</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/atheriel/longears/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="longears" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#longears" class="anchor"></a>longears</h1></div>
<!-- badges: start -->

<p><strong>longears</strong> is a fast and fully-featured RabbitMQ client for R, built on top of the reference C library, <a href="https://github.com/alanxz/rabbitmq-c"><code>librabbitmq</code></a>.</p>
<p><a href="https://www.rabbitmq.com/">RabbitMQ</a> itself is a highly popular, performant, and robust open-source message broker used to build distributed systems.</p>
<p><strong>longears</strong> implements a large portion of the Advanced Message Queuing Protocol (AMQP) used by RabbitMQ , and the API largely reflects <a href="https://www.rabbitmq.com/amqp-0-9-1-reference.html">the protocol itself</a>. However, this package is not a true low-level interface: it abstracts away many details of AMQP for end users. See <a href="#Limitations">Limitations</a> for details.</p>
<p>This package may be of interest to you if you wish to have R speak to your organization’s existing RabbitMQ servers; if you simply need a message queue library, you may be better off with <a href="https://cran.r-project.org/package=txtq"><strong>txtq</strong></a>, <a href="https://cran.r-project.org/package=liteq"><strong>litq</strong></a>, or the ZeroMQ package <a href="https://cran.r-project.org/package=rzmq"><strong>rzmq</strong></a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>To install <strong>longears</strong> as a source package you will need its system dependency, <code>librabbitmq</code>. Normally if this library is missing during installation, the <code>configure</code> script will attempt to download and build it directly (provided you have <code>cmake</code> installed).</p>
<p>You may still wish to use your platform’s provided <code>librabbitmq</code> instead, especially if this process fails. On Debian-based systems (including Ubuntu) you can get this library by running the following from the command line:</p>
<pre class="shell"><code>$ apt install librabbitmq-dev</code></pre>
<p>For other platforms:</p>
<ul>
<li>macOS (via Homebrew): <code>brew install rabbitmq-c</code>
</li>
<li>Fedora-based: <code>yum install librabbitmq-devel</code>
</li>
<li>Arch-based: <code>pacman -S librabbitmq-c</code>
</li>
<li>Windows (via <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a>): <code>pacman -Sy mingw-w64-{i686,x86_64}-rabbitmq-c</code>
</li>
</ul>
<p><strong>longears</strong> is not yet available on CRAN. You can install it from GitHub with</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"atheriel/longears"</span><span class="op">)</span></code></pre></div>
</div>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic Usage</h2>
<p>If you are not already familiar with RabbitMQ and the message/queue/binding/exchange terminology, I suggest their excellent <a href="https://www.rabbitmq.com/tutorials/amqp-concepts.html">conceptual overview</a>.</p>
<p>You will also need to have a local RabbitMQ server running with the default settings to follow this guide.</p>
<pre class="shell"><code>$ # apt install rabbitmq-server
$ systemctl start rabbitmq-server
$ rabbitmqctl status</code></pre>
<p>First, connect to the server (with the default settings):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/amqp_connections.html">amqp_connect</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">conn</span>
<span class="co">#&gt; AMQP Connection:</span>
<span class="co">#&gt;   status:  connected</span>
<span class="co">#&gt;   address: localhost:5672</span>
<span class="co">#&gt;   vhost:   '/'</span></code></pre></div>
<p>Create an exchange to route messages and a couple of queues to store them:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/amqp_exchanges.html">amqp_declare_exchange</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.exchange"</span>, type <span class="op">=</span> <span class="st">"fanout"</span><span class="op">)</span>
<span class="fu"><a href="reference/amqp_queues.html">amqp_declare_queue</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue1"</span><span class="op">)</span>
<span class="co">#&gt; AMQP queue 'my.queue1'</span>
<span class="co">#&gt;   messages:  0</span>
<span class="co">#&gt;   consumers: 0</span>
<span class="fu"><a href="reference/amqp_queues.html">amqp_declare_queue</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue2"</span><span class="op">)</span>
<span class="co">#&gt; AMQP queue 'my.queue2'</span>
<span class="co">#&gt;   messages:  0</span>
<span class="co">#&gt;   consumers: 0</span>
<span class="fu"><a href="reference/amqp_bindings.html">amqp_bind_queue</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue1"</span>, <span class="st">"my.exchange"</span>, routing_key <span class="op">=</span> <span class="st">"#"</span><span class="op">)</span>
<span class="fu"><a href="reference/amqp_bindings.html">amqp_bind_queue</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue2"</span>, <span class="st">"my.exchange"</span>, routing_key <span class="op">=</span> <span class="st">"#"</span><span class="op">)</span></code></pre></div>
<p>You can also set up a consumer for one of these queues with a callback:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">received</span> <span class="op">&lt;-</span> <span class="fl">0</span>
<span class="va">consumer</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/amqp_consume.html">amqp_consume</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue2"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">msg</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">received</span> <span class="op">&lt;&lt;-</span> <span class="va">received</span> <span class="op">+</span> <span class="fl">1</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p>Now, send a few messages to this exchange:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/amqp_publish.html">amqp_publish</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"first"</span>, exchange <span class="op">=</span> <span class="st">"my.exchange"</span>, routing_key <span class="op">=</span> <span class="st">"#"</span><span class="op">)</span>
<span class="fu"><a href="reference/amqp_publish.html">amqp_publish</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"second"</span>, exchange <span class="op">=</span> <span class="st">"my.exchange"</span>, routing_key <span class="op">=</span> <span class="st">"#"</span><span class="op">)</span></code></pre></div>
<p>Check if your messages are going into the queues:</p>
<pre class="shell"><code>$ rabbitmqctl list_queues</code></pre>
<p>You can use <code><a href="reference/amqp_get.html">amqp_get()</a></code> to pull individual messages back into R:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/amqp_get.html">amqp_get</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue1"</span><span class="op">)</span>
<span class="co">#&gt; Delivery Tag:    1</span>
<span class="co">#&gt; Redelivered: FALSE</span>
<span class="co">#&gt; Exchange:    my.exchange</span>
<span class="co">#&gt; Routing Key: #</span>
<span class="co">#&gt; Message Count:   1</span>
<span class="co">#&gt; 66 69 72 73 74</span>
<span class="fu"><a href="reference/amqp_get.html">amqp_get</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue1"</span><span class="op">)</span>
<span class="co">#&gt; Delivery Tag:    2</span>
<span class="co">#&gt; Redelivered: FALSE</span>
<span class="co">#&gt; Exchange:    my.exchange</span>
<span class="co">#&gt; Routing Key: #</span>
<span class="co">#&gt; Message Count:   0</span>
<span class="co">#&gt; 73 65 63 6f 6e 64</span>
<span class="fu"><a href="reference/amqp_get.html">amqp_get</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue1"</span><span class="op">)</span>
<span class="co">#&gt; character(0)</span></code></pre></div>
<p>Or you can use <code><a href="reference/amqp_consume.html">amqp_listen()</a></code> to run consumer callbacks:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/amqp_consume.html">amqp_listen</a></span><span class="op">(</span><span class="va">conn</span>, timeout <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">received</span>
<span class="co">#&gt; [1] 2</span></code></pre></div>
<p>To clean things up, delete the queues, the exchange, and disconnect from the server.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/amqp_queues.html">amqp_delete_queue</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue1"</span><span class="op">)</span>
<span class="fu"><a href="reference/amqp_queues.html">amqp_delete_queue</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.queue2"</span><span class="op">)</span>
<span class="fu"><a href="reference/amqp_exchanges.html">amqp_delete_exchange</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"my.exchange"</span><span class="op">)</span>
<span class="fu"><a href="reference/amqp_connections.html">amqp_disconnect</a></span><span class="op">(</span><span class="va">conn</span><span class="op">)</span>
<span class="va">conn</span>
<span class="co">#&gt; AMQP Connection:</span>
<span class="co">#&gt;   status:  disconnected</span>
<span class="co">#&gt;   address: localhost:5672</span>
<span class="co">#&gt;   vhost:   '/'</span></code></pre></div>
<p>And check that the connection is closed:</p>
<pre class="shell"><code>$ rabbitmqctl list_connections</code></pre>
</div>
<div id="limitations" class="section level2">
<h2 class="hasAnchor">
<a href="#limitations" class="anchor"></a>Limitations</h2>
<p>Some AMQP features are not present, notably transaction support (which there are no plans to implement). Others are handled internally according to best practices, even when they are not exposed through the API – channels, message acknowledgements, and prefetch counts are in this category. A design goal of the package is to shield users from some details, especially if departures from best practice are rare.</p>
<p>If you have need of an AMQP feature (or RabbitMQ extension) that is not currently available or accessible, please consider filing an issue explaining the use case you have in mind.</p>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>The package is licensed under the GPL, version 2 or later.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/atheriel/longears/">https://​github.com/​atheriel/​longears/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/atheriel/longears/issues">https://​github.com/​atheriel/​longears/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Aaron Jacobs <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=longears"><img src="https://www.r-pkg.org/badges/version/longears" alt="CRAN status"></a></li>
<li><a href="https://github.com/atheriel/longears/actions"><img src="https://github.com/atheriel/longears/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Aaron Jacobs.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
